## ç¬¬åç« è€ƒç‚¹
- Sparkç‰¹ç‚¹
- Sparkä¸ŽHadoopæ¯”è¾ƒ
- ä¼˜ç‚¹
- Sparkç”Ÿæ€ç³»ç»Ÿï¼ˆè®¾è®¡ç†å¿µï¼‰
- æ ¸å¿ƒæ¦‚å¿µï¼ˆRDDï¼‰
- è¿›ç¨‹ä¼˜ç‚¹
- RDDè¿è¡ŒåŽŸç†ï¼Œæ‰§è¡Œè¿‡ç¨‹ï¼ŒRDDç‰¹æ€§ï¼Œä¾èµ–å…³ç³»
## ä¸€ã€Sparkæ¦‚è¿°
1. Sparkç®€ä»‹
   Sparkæ˜¯åŸºäºŽå†…å­˜è®¡ç®—çš„å¤§æ•°æ®å¹¶è¡Œæ¡†æž¶
2. ==**Sparkä¸»è¦ç‰¹ç‚¹**==
    - è¿è¡Œé€Ÿåº¦å¿«ï¼šä½¿ç”¨DAGæ‰§è¡Œå¼•æ“Žä»¥æ”¯æŒå¾ªçŽ¯æ•°æ®æµä¸Žå†…å­˜è®¡ç®—
    - å®¹æ˜“ä½¿ç”¨ï¼šæ”¯æŒä½¿ç”¨Scalaã€Javaã€Pythonå’ŒRè¯­è¨€è¿›è¡Œç¼–ç¨‹ï¼Œå¯ä»¥é€šè¿‡Spark Shellè¿›è¡Œäº¤äº’å¼ç¼–ç¨‹
    - é€šç”¨æ€§ï¼šSparkæä¾›äº†å®Œæ•´è€Œå¼ºå¤§çš„æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬SQLæŸ¥è¯¢ã€æµå¼è®¡ç®—ã€æœºå™¨å­¦ä¹ å’Œå›¾ç®—æ³•ç»„ä»¶
    - è¿è¡Œæ¨¡å¼å¤šæ ·ï¼Œå¯ä»¥è¿è¡Œä¸Žç‹¬ç«‹çš„é›†ç¾¤çŽ¯å¢ƒä¸­ï¼Œå¯ä»¥è¿è¡Œä¸ŽHadoopä¸­ï¼Œä¹Ÿå¯ä»¥è¿è¡Œåœ¨Amazon EC2ç­‰äº‘çŽ¯å¢ƒä¸­ï¼Œå¹¶ä¸”å¯ä»¥è®¿é—®HDFSï¼ŒHBaseï¼ŒHiveç­‰å¤šç§æ•°æ®æº
3. Scalaç®€ä»‹
   Scalaæ˜¯ä¸€é—¨çŽ°ä»£å¤šèŒƒå¼å˜æˆè¯­è¨€ï¼Œè¿è¡ŒäºŽJavaå¹³å°ï¼Œå¹¶å…¼å®¹çŽ°æœ‰çš„Javaç¨‹åº
   Scalaç‰¹æ€§
    - Scalaå…·å¤‡å¼ºå¤§çš„å¹¶å‘æ€§ï¼Œæ”¯æŒå‡½æ•°å¼ç¼–ç¨‹ï¼Œå¯ä»¥æ›´å¥½åœ°æ”¯æŒåˆ†å¸ƒå¼ç³»ç»Ÿ
    - Scalaè¯­æ³•ç®€æ´ï¼Œèƒ½å¤Ÿæä¾›ä¼˜é›…çš„API
    - Scalaå…¼å®¹Javaï¼Œè¿è¡Œé€Ÿåº¦å¿«ï¼Œä¸”èƒ½èžåˆåˆ°Hadoopç”Ÿæ€åœˆä¸­
    Scalaæ˜¯Sparkçš„ä¸»è¦ç¼–ç¨‹è¯­è¨€ï¼Œä½†Sparkè¿˜æ”¯æŒJavaã€Pythonã€Rä½œä¸ºç¼–ç¨‹è¯­è¨€ Scalaçš„ä¼˜åŠ¿æ˜¯æä¾›äº†REPLï¼ˆRead-Eval-Print Loopï¼Œäº¤äº’å¼è§£é‡Šå™¨ï¼‰ï¼Œæé«˜ç¨‹åº å¼€å‘æ•ˆçŽ‡
4. ==**Sparkä¸ŽHadoopçš„æ¯”è¾ƒ**==
   Hadoopå­˜åœ¨ä»¥ä¸‹çš„ä¸€äº›ç¼ºç‚¹
    - è¡¨è¾¾èƒ½åŠ›æœ‰é™
    - ç£ç›˜IOå¼€é”€å¤§
    - å»¶è¿Ÿé«˜
	    - ä»»åŠ¡ä¹‹é—´è¡”æŽ¥æ¶‰åŠIOå¼€é”€
	    - åœ¨å‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæˆä¹‹å‰ï¼Œå…¶ä»–ä»»åŠ¡æ— æ³•å¼€å§‹ï¼Œéš¾ä»¥èƒœä»»å¤æ‚çš„ã€å¤šé˜¶æ®µçš„è®¡ç®—ä»»åŠ¡
	Sparkè§£å†³äº†MapReduceçš„ä»¥ä¸‹é—®é¢˜ï¼š
	 - ä½¿ç”¨Hadoopè¿›è¡Œè¿­ä»£è®¡ç®—éžå¸¸è€—è´¹èµ„æº
	 - Sparkå°†æ•°æ®è½½å…¥å†…å­˜ä¹‹åŽï¼Œä¹‹åŽçš„è¿­ä»£ç»“æžœéƒ½å¯ä»¥ç›´æŽ¥ä½¿ç”¨å†…å­˜ä¸­çš„ä¸­é—´ç»“æžœè¿ç®—ï¼Œé¿å…äº†ä»Žç£ç›˜ä¸­é¢‘ç¹è¯»å–æ•°æ®
	==**ç›¸æ¯”Hadoop MapReduceï¼ŒSparkä¸»è¦æœ‰å¦‚ä¸‹ä¼˜ç‚¹**==ï¼š
	 - Sparkçš„è®¡ç®—æ¨¡å¼ä¹Ÿå±žäºŽMapReduceï¼Œä½†æ˜¯ä¸å±€é™äºŽMapå’ŒReduceæ“ä½œï¼Œè¿˜æä¾›äº†å¤šç§æ•°æ®é›†æ“ä½œç±»åž‹ï¼Œç¼–ç¨‹æ¨¡åž‹æ¯”Hadoop MapReduceæ›´åŠ çµæ´»
	 - Sparkæä¾›äº†å†…å­˜è®¡ç®—ï¼Œå¯ä»¥å°†ä¸­é—´ç»“æžœæ”¾åœ¨å†…å­˜ä¸­ï¼Œå¯¹äºŽè¿­ä»£è¿ç®—æ•ˆçŽ‡æ›´é«˜
	 - SparkåŸºäºŽDAGçš„ä»»åŠ¡è°ƒåº¦æ‰§è¡Œæœºåˆ¶ï¼Œè¦ä¼˜äºŽHadoop MapReduceçš„è¿­ä»£æ‰§è¡Œæœºåˆ¶

---
## äºŒã€Sparkç”Ÿæ€ç³»ç»Ÿ
1. åœ¨å®žé™…åº”ç”¨ä¸­ï¼Œå¤§æ•°æ®å¤„ç†ä¸»è¦åŒ…æ‹¬ä»¥ä¸‹ä¸‰ä¸ªç±»åž‹ï¼š
	- å¤æ‚çš„æ‰¹é‡æ•°æ®å¤„ç†ï¼šé€šå¸¸æ—¶é—´è·¨åº¦åœ¨æ•°ååˆ†é’Ÿåˆ°æ•°å°æ—¶ä¹‹é—´ï¼ˆä¾‹å¦‚é‡‘èžæ•°æ®åˆ†æžï¼‰
	- åŸºäºŽåŽ†å²æ•°æ®çš„äº¤äº’å¼æŸ¥è¯¢ï¼šé€šå¸¸æ—¶é—´è·¨åº¦åœ¨æ•°åç§’åˆ°æ•°åˆ†é’Ÿä¹‹é—´ï¼ˆä¾‹å¦‚ç”µå•†ï¼‰ 
	- åŸºäºŽå®žæ—¶æ•°æ®æµçš„æ•°æ®å¤„ç†ï¼šé€šå¸¸æ—¶é—´è·¨åº¦åœ¨æ•°ç™¾æ¯«ç§’åˆ°æ•°ç§’ä¹‹é—´ï¼ˆä¾‹å¦‚ç‰©è”ç½‘ï¼‰ 
	å½“åŒæ—¶å­˜åœ¨ä»¥ä¸Šä¸‰ç§åœºæ™¯æ—¶ï¼Œå°±éœ€è¦åŒæ—¶éƒ¨ç½²ä¸‰ç§ä¸åŒçš„è½¯ä»¶ 
	æ¯”å¦‚: MapReduce / Impala / Storm 
2. è¿™æ ·åšéš¾å…ä¼šå¸¦æ¥ä¸€äº›é—®é¢˜ï¼š 
	 - ä¸åŒåœºæ™¯ä¹‹é—´è¾“å…¥è¾“å‡ºæ•°æ®æ— æ³•åšåˆ°æ— ç¼å…±äº«ï¼Œé€šå¸¸éœ€è¦è¿›è¡Œæ•°æ®æ ¼å¼çš„è½¬æ¢ 
	 - ä¸åŒçš„è½¯ä»¶éœ€è¦ä¸åŒçš„å¼€å‘å’Œç»´æŠ¤å›¢é˜Ÿï¼Œå¸¦æ¥äº†è¾ƒé«˜çš„ä½¿ç”¨æˆæœ¬ 
	 - æ¯”è¾ƒéš¾ä»¥å¯¹åŒä¸€ä¸ªé›†ç¾¤ä¸­çš„å„ä¸ªç³»ç»Ÿè¿›è¡Œç»Ÿä¸€çš„èµ„æºåè°ƒå’Œåˆ†é…
3. ==**Sparkè®¾è®¡ç†å¿µä»¥åŠåŠŸèƒ½**==
	 Sparkçš„è®¾è®¡éµå¾ªâ€œä¸€ä¸ªè½¯ä»¶æ ˆæ»¡è¶³ä¸åŒåº”ç”¨åœºæ™¯â€çš„ç†å¿µï¼Œé€æ¸å½¢æˆäº†ä¸€å¥—å®Œ æ•´çš„ç”Ÿæ€ç³»ç»Ÿã€‚æ—¢èƒ½å¤Ÿæä¾›å†…å­˜è®¡ç®—æ¡†æž¶ï¼Œä¹Ÿå¯ä»¥æ”¯æŒSQLå³å¸­æŸ¥è¯¢ã€å®žæ—¶æµå¼è®¡ç®—ã€æœºå™¨å­¦ä¹ å’Œå›¾è®¡ç®—ç­‰ã€‚Sparkå¯ä»¥éƒ¨ç½²åœ¨èµ„æºç®¡ç†å™¨YARNä¹‹ä¸Šï¼Œæä¾›ä¸€ç«™å¼çš„å¤§æ•°æ®è§£å†³æ–¹æ¡ˆã€‚å› æ­¤ï¼ŒSparkæ‰€æä¾›çš„ç”Ÿæ€ç³»ç»Ÿè¶³ä»¥åº”å¯¹ä¸Šè¿°ä¸‰ç§åœºæ™¯ï¼Œå³åŒæ—¶æ”¯æŒæ‰¹å¤„ç†ã€äº¤äº’å¼æŸ¥è¯¢å’Œæµæ•°æ®å¤„ç†
 ![[Pasted image 20251129150621.png]]

---
## ä¸‰ã€Sparkè¿è¡Œæž¶æž„
### ï¼ˆä¸€ï¼‰Spark æ ¸å¿ƒæ¦‚å¿µå­—å…¸
1.  **RDD (Resilient Distributed Dataset)**
    *   **å®šä¹‰**ï¼šå¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†ã€‚å®ƒä»£è¡¨ä¸€ä¸ªå¼¹æ€§çš„ã€ä¸å¯å˜ã€å¯åˆ†åŒºã€é‡Œé¢çš„å…ƒç´ å¯å¹¶è¡Œè®¡ç®—çš„é›†åˆã€‚æ˜¯åˆ†å¸ƒå¼å†…å­˜çš„ä¸€ä¸ªæŠ½è±¡æ¦‚å¿µï¼Œæä¾›äº†ä¸€ç§é«˜åº¦å— é™çš„å…±äº«å†…å­˜æ¨¡åž‹ã€‚
2.  **DAG (Directed Acyclic Graph)**
    *   **å®šä¹‰**ï¼šæœ‰å‘æ— çŽ¯å›¾ï¼Œåæ˜  RDD ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€‚
3.  **Executor**
    *   **å®šä¹‰**ï¼šè¿è¡Œåœ¨å·¥ä½œèŠ‚ç‚¹ï¼ˆWorkerNodeï¼‰ä¸Šçš„ä¸€ä¸ªè¿›ç¨‹ï¼Œè´Ÿè´£è¿è¡Œ Taskã€‚
4.  **Application**
    *   **å®šä¹‰**ï¼šç”¨æˆ·ç¼–å†™çš„ Spark åº”ç”¨ç¨‹åºï¼ˆåŒ…å« Driver å’Œ Executorï¼‰ã€‚
5.  **Job**
    *   **å®šä¹‰**ï¼šä¸€ä¸ª Job åŒ…å«å¤šä¸ª RDD åŠä½œç”¨äºŽç›¸åº” RDD ä¸Šçš„å„ç§æ“ä½œã€‚
    *   **è§¦å‘**ï¼šé€šå¸¸ç”± Actionï¼ˆåŠ¨ä½œï¼‰ç®—å­è§¦å‘ã€‚
6.  **Stage**
    *   **å®šä¹‰**ï¼šJob çš„åŸºæœ¬è°ƒåº¦å•ä½ï¼Œä¸€ä¸ªJobä¼šåˆ†ä¸ºå¤šç»„Taskï¼Œæ¯ç»„Taskè¢«ç§°ä¸ºStageï¼Œä¹Ÿç§°ä¸º TaskSetã€‚ä»£è¡¨äº†ä¸€ç»„å…³è”çš„ã€**ç›¸äº’ä¹‹é—´æ²¡æœ‰ Shuffle ä¾èµ–å…³ç³»**çš„ä»»åŠ¡ç»„æˆçš„ä»»åŠ¡é›†ã€‚
7.  **Task**
    *   **å®šä¹‰**ï¼šè¿è¡Œåœ¨ Executor ä¸Šçš„æœ€å°å·¥ä½œå•å…ƒã€‚

### ï¼ˆäºŒï¼‰Spark æž¶æž„è®¾è®¡

#### 1. ç‰©ç†èŠ‚ç‚¹ä¸Žç»„ä»¶
Spark è¿è¡Œæž¶æž„ç”±ä»¥ä¸‹å››éƒ¨åˆ†ç»„æˆï¼š
![[Pasted image 20251129151102.png]]
*   **Cluster Manager (é›†ç¾¤èµ„æºç®¡ç†å™¨)**ï¼šè´Ÿè´£èµ„æºç®¡ç†ï¼ˆå¯è‡ªå¸¦ï¼Œä¹Ÿå¯ä½¿ç”¨ Mesos æˆ– YARNï¼‰ã€‚
*   **Worker Node (å·¥ä½œèŠ‚ç‚¹)**ï¼šè¿è¡Œä½œä¸šä»»åŠ¡çš„èŠ‚ç‚¹ã€‚
*   **Driver (é©±åŠ¨èŠ‚ç‚¹)**ï¼šæ¯ä¸ªåº”ç”¨çš„ä»»åŠ¡æŽ§åˆ¶èŠ‚ç‚¹ã€‚
*   **Executor (æ‰§è¡Œè¿›ç¨‹)**ï¼šæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šè´Ÿè´£å…·ä½“ä»»åŠ¡çš„æ‰§è¡Œè¿›ç¨‹ã€‚

#### 2. Executor çš„ä¼˜åŠ¿ (å¯¹æ¯” Hadoop MapReduce)
**Spark çš„ Executor è¿›ç¨‹ç›¸æ¯” Hadoop MapReduce æœ‰ä¸¤ä¸ªæ˜¾è‘—ä¼˜ç‚¹ï¼š**
1.  **å¤šçº¿ç¨‹æ¨¡åž‹**ï¼šåˆ©ç”¨å¤šçº¿ç¨‹æ‰§è¡Œå…·ä½“ä»»åŠ¡ï¼Œå‡å°‘äº†ä»»åŠ¡å¯åŠ¨çš„å¼€é”€ï¼ˆMR é‡‡ç”¨è¿›ç¨‹æ¨¡åž‹ï¼‰ã€‚
2.  **BlockManager å­˜å‚¨æ¨¡å—**ï¼šå°†å†…å­˜å’Œç£ç›˜å…±åŒä½œä¸ºå­˜å‚¨è®¾å¤‡ï¼Œä¸éœ€è¦è¯»å†™ HDFSï¼Œæœ‰æ•ˆå‡å°‘ IO å¼€é”€ã€‚

#### 3. å„ç§æ¦‚å¿µä¹‹é—´ç›¸äº’å…³ç³»
- ä¸€ä¸ªApplicationç”±ä¸€ä¸ªDriverå’Œè‹¥å¹²ä¸ªJobæž„æˆï¼Œä¸€ä¸ªJobç”±å¤šä¸ªStageæž„æˆï¼Œä¸€ä¸ª Stageç”±å¤šä¸ªæ²¡æœ‰Shuffleå…³ç³»çš„Taskç»„æˆã€
- å½“æ‰§è¡Œä¸€ä¸ªApplicationæ—¶ï¼ŒDriverä¼šå‘é›†ç¾¤ç®¡ç†å™¨ç”³è¯·èµ„æºï¼Œå¯åŠ¨Executorï¼Œå¹¶å‘ Executorå‘é€åº”ç”¨ç¨‹åºä»£ç å’Œæ–‡ä»¶ï¼Œç„¶åŽåœ¨Executorä¸Šæ‰§è¡ŒTaskï¼Œè¿è¡Œç»“æŸåŽï¼Œæ‰§ è¡Œç»“æžœä¼šè¿”å›žç»™Driverï¼Œæˆ–è€…å†™åˆ°HDFSæˆ–è€…å…¶ä»–æ•°æ®åº“ä¸­

#### 4.==æž¶æž„ç‰¹ç‚¹==
*   **ä¸“å±žè¿›ç¨‹**ï¼šæ¯ä¸ª Application éƒ½æœ‰ä¸“å±žçš„ Executor è¿›ç¨‹ï¼Œä¸”åœ¨è¿è¡ŒæœŸé—´ä¸€ç›´é©»ç•™ã€‚
*   **è§£è€¦**ï¼šSpark è¿è¡Œè¿‡ç¨‹ä¸Žèµ„æºç®¡ç†å™¨æ— å…³ï¼Œåªè¦èƒ½èŽ·å– Executor è¿›ç¨‹å¹¶ä¿æŒé€šä¿¡å³å¯ã€‚
*   **ä¼˜åŒ–æœºåˆ¶**ï¼šTask é‡‡ç”¨äº†æ•°æ®æœ¬åœ°æ€§å’ŒæŽ¨æµ‹æ‰§è¡Œç­‰ä¼˜åŒ–æœºåˆ¶ã€‚

### ï¼ˆä¸‰ï¼‰æ ¸å¿ƒæŠ½è±¡ï¼šRDD (å¼¹æ€§åˆ†å¸ƒå¼æ•°æ®é›†)

#### 1. è®¾è®¡èƒŒæ™¯
*   **ç—›ç‚¹**ï¼šMapReduce å°†ä¸­é—´ç»“æžœå†™å…¥ HDFSï¼Œå¯¼è‡´å¤§é‡æ•°æ®å¤åˆ¶ã€ç£ç›˜ IO å’Œåºåˆ—åŒ–å¼€é”€ï¼Œä¸é€‚åˆè¿­ä»£ç®—æ³•å’Œäº¤äº’å¼æ•°æ®æŒ–æŽ˜ã€‚
*   **è§£å†³**ï¼šRDD æä¾›æŠ½è±¡æ•°æ®æž¶æž„ï¼Œé€šè¿‡**ç®¡é“åŒ– (Pipeline)** é¿å…ä¸­é—´æ•°æ®å­˜å‚¨ï¼Œä¸å¿…æ‹…å¿ƒåº•å±‚åˆ†å¸ƒå¼ç‰¹æ€§ã€‚

#### 2.==RDD æ ¸å¿ƒæ¦‚å¿µ==
*   **æœ¬è´¨**ï¼šåªè¯»çš„åˆ†åŒºè®°å½•é›†åˆã€‚æ¯ä¸ª RDD åˆ†æˆå¤šä¸ªåˆ†åŒºï¼Œåˆ†å¸ƒåœ¨é›†ç¾¤ä¸åŒèŠ‚ç‚¹ä¸Šè¿›è¡Œå¹¶è¡Œè®¡ç®—ã€‚
*   **åˆ›å»ºæ–¹å¼**ï¼šåªèƒ½åŸºäºŽç¨³å®šçš„ç‰©ç†å­˜å‚¨ï¼ˆå¦‚ HDFSï¼‰åˆ›å»ºï¼Œæˆ–é€šè¿‡å…¶ä»– RDD æ‰§è¡Œè½¬æ¢æ“ä½œï¼ˆmap, join ç­‰ï¼‰åˆ›å»ºã€‚
*   **å—é™æ¨¡åž‹**ï¼šä¸æ”¯æŒç»†ç²’åº¦ä¿®æ”¹ï¼ˆä¸é€‚åˆçˆ¬è™«ï¼‰ï¼Œåªæ”¯æŒç²—ç²’åº¦è½¬æ¢ï¼ˆé€‚åˆ MR, SQL, Pregelï¼‰ã€‚
*   **å­˜å‚¨**ï¼šæ•°æ®å¯ä»¥æ˜¯ Java å¯¹è±¡ï¼Œé¿å…ä¸å¿…è¦çš„åºåˆ—åŒ–/ååºåˆ—åŒ–å¼€é”€ã€‚

#### 3. æ“ä½œç±»åž‹
*   **è½¬æ¢ (Transformation)**ï¼šæƒ°æ€§è°ƒç”¨ï¼Œä¸ç«‹å³æ‰§è¡Œï¼Œæž„å»ºè¡€ç¼˜å…³ç³»ï¼ˆå¦‚ map, filterï¼‰ã€‚
*   **åŠ¨ä½œ (Action)**ï¼šè§¦å‘å®žé™…è®¡ç®—ï¼Œè¾“å‡ºç»“æžœæˆ–ä¿å­˜ï¼ˆå¦‚ count, saveAsTextFileï¼‰ã€‚

#### 4. é«˜æ•ˆå®¹é”™æœºåˆ¶
*   **ä¼ ç»Ÿæ–¹å¼**ï¼šæ•°æ®å¤åˆ¶æˆ–è®°å½•æ—¥å¿—ã€‚
*   **RDD æ–¹å¼**ï¼šåˆ©ç”¨ **Lineage (è¡€ç¼˜å…³ç³»)**ã€‚
    *   åªè®°å½•ç²—ç²’åº¦çš„æ“ä½œã€‚
    *   ä¸¢å¤±åˆ†åŒºæ—¶ï¼Œæ ¹æ®è¡€ç¼˜å…³ç³»é‡æ–°è®¡ç®—ã€‚
    *   é‡ç®—è¿‡ç¨‹åœ¨ä¸åŒèŠ‚ç‚¹å¹¶è¡Œï¼Œæ— éœ€å›žæ»šç³»ç»Ÿã€‚

#### 5. ==ä¾èµ–å…³ç³»ä¸Ž Stage åˆ’åˆ† (å…³é”®)==
RDD çš„ä¾èµ–å…³ç³»å†³å®šäº† Stage çš„åˆ’åˆ†ï¼š

*   **ä¾èµ–ç±»åž‹**ï¼š
    *   **çª„ä¾èµ– (Narrow Dependency)**ï¼šçˆ¶ RDD çš„ä¸€ä¸ªåˆ†åŒºå¯¹åº”å­ RDD çš„ä¸€ä¸ªåˆ†åŒºï¼ˆ1å¯¹1 æˆ– Nå¯¹1ï¼‰ã€‚**æœ‰åˆ©äºŽæµæ°´çº¿ä¼˜åŒ–**ã€‚
    *   **å®½ä¾èµ– (Wide Dependency)**ï¼šçˆ¶ RDD çš„ä¸€ä¸ªåˆ†åŒºå¯¹åº”å­ RDD çš„å¤šä¸ªåˆ†åŒºï¼ˆ1å¯¹Nï¼‰ï¼Œå­˜åœ¨ **Shuffle** è¿‡ç¨‹ã€‚**æ— æ³•æµæ°´çº¿ä¼˜åŒ–**ã€‚

*   **Stage åˆ’åˆ†ç®—æ³•**ï¼š
    1.  SparkContext åˆ†æž RDD ä¾èµ–ç”Ÿæˆ DAGã€‚
    2.  åœ¨ DAG ä¸­è¿›è¡Œ**åå‘è§£æž**ã€‚
    3.  **é‡åˆ°å®½ä¾èµ–å°±æ–­å¼€**ï¼Œåˆ’åˆ†ä¸ºä¸åŒçš„ Stageã€‚
    4.  **é‡åˆ°çª„ä¾èµ–å°±åŠ å…¥å½“å‰ Stage**ï¼Œå°½é‡å°†çª„ä¾èµ–åˆ’åˆ†åœ¨åŒä¸€ä¸ª Stage ä¸­ä»¥å®žçŽ°â€œæµæ°´çº¿â€è®¡ç®—ã€‚

    > **ç¤ºä¾‹**ï¼šStage å†…éƒ¨ï¼ˆå¦‚ map åˆ° unionï¼‰å…¨æ˜¯çª„ä¾èµ–ï¼Œå½¢æˆæµæ°´çº¿ï¼›Stage ä¹‹é—´ç”± Shuffleï¼ˆå®½ä¾èµ–ï¼‰åˆ†éš”ã€‚

### ï¼ˆå››ï¼‰==Spark è¿è¡ŒåŸºæœ¬æµç¨‹==
![[Pasted image 20251129151538.png]]
ä¸€ä¸ª Application ç”±ä¸€ä¸ª Driver å’Œè‹¥å¹² Job æž„æˆï¼ŒJob ç”±å¤šä¸ª Stage æž„æˆï¼ŒStage ç”±å¤šä¸ª Task ç»„æˆã€‚å…·ä½“æµç¨‹å¦‚ä¸‹ï¼š

1.  **çŽ¯å¢ƒæž„å»º**ï¼š
    *   Driver å¯åŠ¨ï¼Œåˆ›å»º **SparkContext**ã€‚
    *   SparkContext è´Ÿè´£èµ„æºç”³è¯·ã€ä»»åŠ¡åˆ†é…å’Œç›‘æŽ§ã€‚
2.  **èµ„æºå¯åŠ¨**ï¼š
    *   èµ„æºç®¡ç†å™¨ä¸º Application åˆ†é…èµ„æºï¼Œå¯åŠ¨ **Executor** è¿›ç¨‹ã€‚
    *   Driver å‘ Executor å‘é€åº”ç”¨ç¨‹åºä»£ç å’Œæ–‡ä»¶ã€‚
3.  **DAG æž„å»ºä¸Žè§£æž**ï¼š
    *   SparkContext æ ¹æ® RDD ä¾èµ–å…³ç³»æž„å»º **DAG å›¾**ã€‚
    *   DAG æäº¤ç»™ **DAGScheduler**ã€‚
    *   DAGScheduler å°† DAG è§£æžæˆå¤šä¸ª **Stage (TaskSet)**ã€‚
4.  **ä»»åŠ¡è°ƒåº¦**ï¼š
    *   DAGScheduler å°† TaskSet æäº¤ç»™åº•å±‚è°ƒåº¦å™¨ **TaskScheduler**ã€‚
    *   TaskScheduler å°† **Task** å‘æ”¾ç»™ Executor è¿è¡Œã€‚
5.  **ä»»åŠ¡æ‰§è¡Œ**ï¼š
    *   Executor ä»¥å¤šçº¿ç¨‹æ–¹å¼è¿è¡Œ Taskã€‚
    *   æ‰§è¡Œç»“æžœåé¦ˆç»™ TaskSchedulerï¼Œå†åé¦ˆç»™ DAGSchedulerã€‚
6.  **ç»“æŸ**ï¼š
    *   è¿è¡Œå®Œæ¯•åŽå†™å…¥æ•°æ®ï¼ˆHDFSæˆ–å…¶ä»–æ•°æ®åº“ï¼‰ï¼Œé‡Šæ”¾èµ„æºã€‚

#### æ€»ç»“ RDD åœ¨æž¶æž„ä¸­çš„æµè½¬ï¼š
1.  åˆ›å»º RDD å¯¹è±¡ã€‚
2.  **SparkContext** æž„å»º DAGã€‚
3.  **DAGScheduler** æ‹†åˆ† Stageã€‚
4.  **TaskScheduler** åˆ†å‘ Taskã€‚
5.  **Executor** æ‰§è¡Œ Taskã€‚
---
## å››ã€Spark SQL
### ï¼ˆä¸€ï¼‰å‰èº«ï¼šShark (Hive on Spark)
#### 1. åŸºæœ¬åŽŸç†
*   **å®šä¹‰**ï¼šShark æœ¬è´¨ä¸Šæ˜¯ **Hive on Spark**ã€‚
*   **è®¾è®¡ç›®æ ‡**ï¼šå®žçŽ°ä¸Ž Hive çš„å…¼å®¹ã€‚
*   **å®žçŽ°æ–¹å¼**ï¼š
    *   **é‡ç”¨ Hive é€»è¾‘**ï¼šåœ¨ HiveQL è§£æžã€é€»è¾‘æ‰§è¡Œè®¡åˆ’ç¿»è¯‘ã€æ‰§è¡Œè®¡åˆ’ä¼˜åŒ–ç­‰æ–¹é¢ï¼Œå®Œå…¨é‡ç”¨äº† Hive çš„åŽŸç”Ÿé€»è¾‘ã€‚
    *   **æ›¿æ¢ç‰©ç†å¼•æ“Ž**ï¼šä»…å°†ç‰©ç†æ‰§è¡Œè®¡åˆ’ä»Ž Hadoop **MapReduce** ä½œä¸šæ›¿æ¢æˆäº† **Spark** ä½œä¸šã€‚
    *   **æµç¨‹**ï¼š`HiveQL` -> `Hiveè§£æž` -> `Spark RDDæ“ä½œ`ã€‚
#### 2. å­˜åœ¨çš„ä¸¤å¤§ç¼ºé™·
Shark çš„æž¶æž„è®¾è®¡ï¼ˆé‡åº¦ä¾èµ– Hiveï¼‰å¯¼è‡´äº†ä»¥ä¸‹æ— æ³•å…‹æœçš„é—®é¢˜ï¼š
1.  **ä¼˜åŒ–å—é™**ï¼š
    *   æ‰§è¡Œè®¡åˆ’ä¼˜åŒ–å®Œå…¨ä¾èµ–äºŽ Hiveï¼Œå¯¼è‡´æ— æ³•æ–¹ä¾¿åœ°æ·»åŠ  Spark ä¸“æœ‰çš„ä¼˜åŒ–ç­–ç•¥ã€‚
2.  **çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ˆç»´æŠ¤æˆæœ¬é«˜ï¼‰**ï¼š
    *   **Spark** æ˜¯**çº¿ç¨‹çº§**å¹¶è¡Œã€‚
    *   **MapReduce** æ˜¯**è¿›ç¨‹çº§**å¹¶è¡Œã€‚
    *   **ç»“æžœ**ï¼šä¸ºäº†è§£å†³ Spark åœ¨å…¼å®¹ Hive å®žçŽ°ä¸Šçš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼ŒShark ä¸å¾—ä¸ç»´æŠ¤ä¸€å¥—ç‹¬ç«‹çš„ã€æ‰“äº†è¡¥ä¸çš„ Hive æºç åˆ†æ”¯ã€‚
### ï¼ˆäºŒï¼‰Spark SQL æž¶æž„
#### 1. æž¶æž„æ”¹è¿›ï¼ˆå¯¹æ¯” Sharkï¼‰
Spark SQL æ‘’å¼ƒäº†å¯¹ Hive çš„é‡åº¦ä¾èµ–ï¼Œå®žçŽ°äº†æ›´å½»åº•çš„æŽ¥ç®¡ï¼š
*   **ä»…ä¾èµ–ä¸¤ç‚¹**ï¼šSpark SQL åœ¨ Hive å…¼å®¹å±‚é¢ï¼Œä»…ä¾èµ– **HiveQL è§£æž** å’Œ **Hive å…ƒæ•°æ®**ã€‚
*   **æŽ¥ç®¡æ—¶æœº**ï¼šä»Ž HQL è¢«è§£æžæˆ **æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰** èµ·ï¼ŒåŽç»­å·¥ä½œå°±å…¨éƒ¨ç”± Spark SQL æŽ¥ç®¡ã€‚
#### 2. æ ¸å¿ƒç»„ä»¶ï¼šCatalyst
*   **å®šä¹‰**ï¼šå‡½æ•°å¼å…³ç³»æŸ¥è¯¢ä¼˜åŒ–æ¡†æž¶ã€‚
*   **èŒè´£**ï¼šè´Ÿè´£ Spark SQL çš„ **æ‰§è¡Œè®¡åˆ’ç”Ÿæˆ** å’Œ **ä¼˜åŒ–**ã€‚
### ï¼ˆä¸‰ï¼‰Spark SQL æ ¸å¿ƒæ¦‚å¿µä¸Žç‰¹æ€§

#### 1. æ•°æ®æŠ½è±¡ï¼šSchemaRDD
*   **å®šä¹‰**ï¼šå¸¦æœ‰ **Schema**ï¼ˆç»“æž„/å…ƒæ•°æ®ï¼‰ä¿¡æ¯çš„ RDDã€‚
    *   *æ³¨ï¼šSchemaRDD æ˜¯ DataFrame çš„å‰èº«ï¼Œæ¦‚å¿µä¸Šç­‰åŒäºŽâ€œç»“æž„åŒ–æ•°æ®â€ã€‚*
*   **ç‰¹ç‚¹**ï¼š
    *   ä¸Žæ™®é€š RDD ç›¸ä¼¼ï¼Œä½†å…·æœ‰é¢å¤–çš„ç»“æž„ä¿¡æ¯ï¼ˆæ•°æ®å­—æ®µçš„ç±»åž‹ä¿¡æ¯ï¼‰ã€‚
    *   å…è®¸ç”¨æˆ·åœ¨ Spark SQL ä¸­ç›´æŽ¥æ‰§è¡Œ SQL è¯­å¥ã€‚
#### 2. æ•°æ®æºæ”¯æŒ
Spark SQL å…·æœ‰æžä½³çš„å…¼å®¹æ€§ï¼Œæ•°æ®å¯ä»¥æ¥è‡ªï¼š
*   å†…å­˜ä¸­çš„ RDD
*   Hive
*   HDFS
*   Cassandra
*   JSON æ ¼å¼æ•°æ®
*   å…¶ä»–å¤–éƒ¨æ•°æ®æº
#### 3. å¤šè¯­è¨€æ”¯æŒ
ç›®å‰æ”¯æŒä¸‰ç§ç¼–ç¨‹è¯­è¨€è¿›è¡Œå¼€å‘ï¼š
*   Scala
*   Java
*   Python
### æ€»ç»“ï¼šShark vs Spark SQL

| æ¯”è¾ƒç»´åº¦ | Shark | Spark SQL |
| :--- | :--- | :--- |
| **æœ¬è´¨** | Hive on Spark (ä¿®æ”¹ç‰ˆ Hive) | Spark çš„ä¸€ä¸ªç‹¬ç«‹æ¨¡å— |
| **ä¾èµ– Hive ç¨‹åº¦** | **é‡åº¦ä¾èµ–** (è§£æžã€ä¼˜åŒ–ã€é€»è¾‘è®¡åˆ’å…¨é  Hive) | **è½»åº¦ä¾èµ–** (ä»…ç”¨ HiveQL è§£æžå’Œå…ƒæ•°æ®) |
| **ä¼˜åŒ–å™¨** | Hive ä¼˜åŒ–å™¨ | **Catalyst** (Spark ä¸“ç”¨ä¼˜åŒ–å™¨) |
| **ä¸­é—´å½¢å¼** | æ™®é€š RDD | SchemaRDD (ç»“æž„åŒ– RDD) |
| **ä¸»è¦ç—›ç‚¹** | çº¿ç¨‹å®‰å…¨é—®é¢˜ã€ä¼˜åŒ–æ‰©å±•éš¾ | (è§£å†³äº† Shark çš„ç—›ç‚¹) |

---
## äº”ã€Sparkçš„éƒ¨ç½²å’Œåº”ç”¨æ–¹å¼
### ï¼ˆä¸€ï¼‰Spark ä¸‰ç§éƒ¨ç½²æ¨¡å¼
Spark æ”¯æŒå¤šç§é›†ç¾¤ç®¡ç†å™¨ï¼Œä¸»è¦åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š
1.  **Standalone (è‡ªå¸¦æ¨¡å¼)**
    *   Spark åŽŸç”Ÿè‡ªå¸¦çš„èµ„æºç®¡ç†æ¨¡å¼ã€‚
    *   **ç‰¹ç‚¹**ï¼šç±»ä¼¼äºŽ MapReduce 1.0ã€‚
    *   **èµ„æºå•ä½**ï¼šä»¥ **Slot** ä¸ºèµ„æºåˆ†é…å•ä½ã€‚
2.  **Spark on Mesos**
    *   **ç‰¹ç‚¹**ï¼šç”±äºŽ Spark å’Œ Mesos æœ‰è¡€ç¼˜å…³ç³»ï¼ˆåŒå‡ºåé—¨ï¼‰ï¼Œå› æ­¤ Spark å¯¹ Mesos æœ‰æ›´å¥½çš„æ”¯æŒã€‚
3.  **Spark on YARN**
    *   **ç‰¹ç‚¹**ï¼šè¿è¡Œåœ¨ Hadoop çš„ YARN èµ„æºç®¡ç†å™¨ä¸Šï¼Œæ˜¯ä¼ä¸šä¸­æœ€é€šç”¨çš„éƒ¨ç½²æ–¹å¼ã€‚
### ï¼ˆäºŒï¼‰Spark æž¶æž„çš„è¿ç»´ä¸Žå¼€å‘ä¼˜åŠ¿
é‡‡ç”¨ Spark æž¶æž„å¸¦æ¥ä»¥ä¸‹ä¾¿åˆ©ï¼š

1.  **æ˜“äºŽéƒ¨ç½²**ï¼šæ”¯æŒä¸€é”®å¼å®‰è£…å’Œé…ç½®ã€‚
2.  **ç²¾ç»†ç›‘æŽ§**ï¼šæä¾› **çº¿ç¨‹çº§åˆ«** çš„ä»»åŠ¡ç›‘æŽ§å’Œå‘Šè­¦ï¼ˆç›¸æ¯” MR çš„è¿›ç¨‹çº§æ›´ç»†è‡´ï¼‰ã€‚
3.  **é™ä½Žé—¨æ§›**ï¼š
    *   é™ä½Žäº†ç¡¬ä»¶é›†ç¾¤å’Œè½¯ä»¶ç»´æŠ¤çš„éš¾åº¦ã€‚
    *   é™ä½Žäº†ä»»åŠ¡ç›‘æŽ§å’Œåº”ç”¨å¼€å‘çš„éš¾åº¦ã€‚
4.  **èµ„æºæ•´åˆ**ï¼šä¾¿äºŽæž„å»ºç»Ÿä¸€çš„ç¡¬ä»¶ä¸Žè®¡ç®—å¹³å°èµ„æºæ± ã€‚

### ï¼ˆä¸‰ï¼‰æŠ€æœ¯é€‰åž‹æ³¨æ„ï¼šå®žæ—¶è®¡ç®—çš„é™åˆ¶

*   **Spark Streaming çš„å±€é™**ï¼š
    *   æ— æ³•å®žçŽ°çœŸæ­£çš„ **æ¯«ç§’çº§** æµè®¡ç®—ï¼ˆæœ¬è´¨æ˜¯å¾®æ‰¹å¤„ç†ï¼‰ã€‚
*   **é€‰åž‹å»ºè®®**ï¼š
    *   å¯¹äºŽéœ€è¦ **æ¯«ç§’çº§å®žæ—¶å“åº”** çš„ä¼ä¸šåº”ç”¨ï¼ŒSpark Streaming å¯èƒ½ä¸é€‚ç”¨ã€‚
    *   å»ºè®®é‡‡ç”¨ **Storm** æˆ– Flinkï¼ˆçŽ°ä»£æ›¿ä»£æ–¹æ¡ˆï¼‰ç­‰çº¯æµå¼è®¡ç®—æ¡†æž¶ã€‚

### ï¼ˆå››ï¼‰Hadoop ä¸Ž Spark çš„ç»Ÿä¸€éƒ¨ç½² (åŸºäºŽ YARN)

#### 1. ä¸ºä»€ä¹ˆè¦ç»Ÿä¸€éƒ¨ç½²ï¼Ÿ
ç›®å‰ Spark æ— æ³•å®Œå…¨å–ä»£ Hadoop ç”Ÿæ€ï¼Œä¸¤è€…éœ€è¦å…±å­˜ï¼š
*   **åŠŸèƒ½äº’è¡¥**ï¼šHadoop ç”Ÿæ€ä¸­éƒ¨åˆ†ç»„ä»¶åŠŸèƒ½ï¼ˆå¦‚ Storm çš„æ¯«ç§’çº§å“åº”ï¼‰Spark æš‚æ—¶æ— æ³•å®Œå…¨æ›¿ä»£ã€‚
*   **è¿ç§»æˆæœ¬**ï¼šå°†çŽ°æœ‰çš„ Hadoop ç»„ä»¶åº”ç”¨å®Œå…¨è½¬ç§»åˆ° Spark ä¸Šéœ€è¦ä¸€å®šçš„é‡æž„æˆæœ¬ã€‚

#### 2. ç»Ÿä¸€è¿è¡Œåœ¨ YARN ä¸Šçš„ä¸‰å¤§å¥½å¤„
å°†ä¸åŒçš„è®¡ç®—æ¡†æž¶ï¼ˆSpark, MapReduce, Storm ç­‰ï¼‰ç»Ÿä¸€è¿è¡Œåœ¨ **YARN** ä¸Šï¼Œæœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š

1.  **èµ„æºæŒ‰éœ€ä¼¸ç¼©**ï¼šè®¡ç®—èµ„æºå¯ä»¥æ ¹æ®ä»»åŠ¡éœ€æ±‚åŠ¨æ€è°ƒæ•´ã€‚
2.  **é›†ç¾¤åˆ©ç”¨çŽ‡é«˜**ï¼šä¸åŒç±»åž‹çš„åº”ç”¨ï¼ˆä¸ç”¨è´Ÿè½½åº”ç”¨ï¼‰æ··æ­è¿è¡Œï¼Œé¿å…é—²ç½®ã€‚
3.  **å…±äº«åº•å±‚å­˜å‚¨**ï¼šæ‰€æœ‰æ¡†æž¶å…±äº« HDFSï¼Œé¿å…äº†æ•°æ®åœ¨ä¸åŒé›†ç¾¤é—´è¿ç§»ã€å¤åˆ¶çš„å¼€é”€ã€‚

---
## å…­ã€Sparkç¼–ç¨‹å®žè·µ
### ï¼ˆä¸€ï¼‰RDD ç¼–ç¨‹å…¥å£ï¼šSparkContext

1.  **æ ¸å¿ƒå¯¹è±¡**
    *   **SparkContext** æ˜¯ Spark ç¨‹åºçš„å”¯ä¸€å…¥å£ã€‚
    *   **èŒè´£**ï¼šè´Ÿè´£åˆ›å»º RDDã€å¯åŠ¨ä»»åŠ¡ã€è¿žæŽ¥é›†ç¾¤ç­‰ã€‚
2.  **èŽ·å–æ–¹å¼**
    *   **ä»£ç ä¸­**ï¼šå¿…é¡»æ˜¾ç¤ºåˆ›å»ºä¸€ä¸ª SparkContext å¯¹è±¡ã€‚
    *   **Spark Shell ä¸­**ï¼šå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨åˆ›å»ºè¯¥å¯¹è±¡ï¼Œå¯ä»¥é€šè¿‡å˜é‡ **`sc`** ç›´æŽ¥è®¿é—®ã€‚

### ï¼ˆäºŒï¼‰RDD çš„ä¸¤å¤§æ“ä½œç±»åž‹
Spark çš„ RDD æ“ä½œåˆ†ä¸ºä¸¤ç±»ï¼Œé€»è¾‘éžå¸¸æ¸…æ™°ï¼Œè¯·åŠ¡å¿…åŒºåˆ†ï¼š

| æ“ä½œç±»åž‹   | å…³é”®å­—                | å®šä¹‰/ä½œç”¨                 | è¿”å›žå€¼                | ç¤ºä¾‹                 |
| :----- | :----------------- | :-------------------- | :----------------- | :----------------- |
| **è½¬æ¢** | **Transformation** | åŸºäºŽçŽ°æœ‰æ•°æ®é›†åˆ›å»ºä¸€ä¸ª**æ–°çš„ RDD** | **æ–° RDD** (ä¸ä¼šç«‹å³è®¡ç®—) | `filter`, `map`    |
| **åŠ¨ä½œ** | **Action**         | åœ¨æ•°æ®é›†ä¸Šè¿›è¡Œè¿ç®—ï¼Œè§¦å‘å®žé™…æ‰§è¡Œ      | **å…·ä½“è®¡ç®—ç»“æžœ** (éž RDD) | `count`, `collect` |

> **æ³¨æ„**ï¼šTransformation æ˜¯æƒ°æ€§çš„ï¼ˆLazyï¼‰ï¼Œåªæœ‰é‡åˆ° Action æ—¶æ‰ä¼šçœŸæ­£æ‰§è¡Œè®¡ç®—ã€‚

### ï¼ˆä¸‰ï¼‰ä»£ç å®žæˆ˜ç¤ºä¾‹

ä»¥ä¸‹ç¤ºä¾‹æ¼”ç¤ºäº†ä»Žâ€œè¯»å–æ–‡ä»¶â€åˆ°â€œç­›é€‰æ•°æ®â€çš„å…¨è¿‡ç¨‹ã€‚
*å‡è®¾æ•°æ®æºä¸º Spark å®‰è£…ç›®å½•ä¸‹çš„ `README.md` æ–‡ä»¶ã€‚*

#### 1. åˆ›å»º RDD (è¯»å–æ•°æ®)
ä½¿ç”¨ `sc.textFile` ä»Žå¤–éƒ¨å­˜å‚¨ç³»ç»Ÿè¯»å–æ•°æ®ã€‚
```scala
// file:// è¡¨ç¤ºè¯»å–æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œè€Œéž HDFS
val textFile = sc.textFile("file:///usr/local/spark/README.md")
```

#### 2. æ‰§è¡ŒåŠ¨ä½œ (Action)
ç»Ÿè®¡æ–‡æœ¬çš„æ€»è¡Œæ•°ã€‚
```scala
textFile.count()
// è¾“å‡ºç»“æžœ: Long = 95 (è¡¨ç¤ºå…±æœ‰ 95 è¡Œ)
```

#### 3. æ‰§è¡Œè½¬æ¢ (Transformation)
ä½¿ç”¨ `filter` ç®—å­ç­›é€‰å‡ºåŒ…å« "Spark" å­—ç¬¦ä¸²çš„è¡Œã€‚
```scala
// line => line.contains("Spark") æ˜¯ä¸€ä¸ªåŒ¿åå‡½æ•°ï¼Œè¡¨ç¤ºç­›é€‰é€»è¾‘
// è¿™è¡Œä»£ç æ‰§è¡ŒåŽï¼Œè¿”å›žä¸€ä¸ªæ–°çš„ RDDï¼Œåä¸º linesWithSpark
val linesWithSpark = textFile.filter(line => line.contains("Spark"))
```

#### 4. é“¾å¼è°ƒç”¨
å¯¹ç­›é€‰åŽçš„æ–° RDD å†æ¬¡æ‰§è¡Œ Action æ“ä½œã€‚
```scala
linesWithSpark.count()
// è¾“å‡ºç»“æžœ: Long = 17 (è¡¨ç¤ºåŒ…å« "Spark" çš„è¡Œæœ‰ 17 è¡Œ)
```

### ðŸ’¡ æµç¨‹æ€»ç»“å›¾è§£
1.  **`sc.textFile`** (åŠ è½½) -> å¾—åˆ° RDD1
2.  **`filter`** (è½¬æ¢ RDD1) -> å¾—åˆ° RDD2
3.  **`count`** (å¯¹ RDD2 åŠ¨ä½œ) -> å¾—åˆ° ç»“æžœ (17)